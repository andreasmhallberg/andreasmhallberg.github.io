<!DOCTYPE html>
<html>
  <head>
    <title>The typography of ʿ and ʾ and a method to render them from scratch in LaTeX – Uppercase Alif – Andreas Hallberg's notes on Arabic linguistics, Vim and LaTeX.</title>
        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="In this post I describe typographical problems introduced by the characters ʿ and ʾ used in transcription of Arabic. I present a font independent (well, largely) method of rendering them in LaTeX with the XeTeX engine. The code used for this is explained in some detail and is given in its entirety at the end of this post.

" />
    <meta property="og:description" content="In this post I describe typographical problems introduced by the characters ʿ and ʾ used in transcription of Arabic. I present a font independent (well, largely) method of rendering them in LaTeX with the XeTeX engine. The code used for this is explained in some detail and is given in its entirety at the end of this post.

" />
    
    <meta name="author" content="Uppercase Alif" />

    
    <meta property="og:title" content="The typography of ʿ and ʾ and a method to render them from scratch in LaTeX" />
    <meta property="twitter:title" content="The typography of ʿ and ʾ and a method to render them from scratch in LaTeX" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="shortcut icon" type="image/x-icon" href="/logo/favicon.png"> 
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Uppercase Alif - Andreas Hallberg's notes on Arabic linguistics, Vim and LaTeX." href="/feed.xml" />

    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77917262-1', 'auto');
  ga('send', 'pageview');

</script>




    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>The typography of ʿ and ʾ and a method to render them from scratch in LaTeX | Uppercase Alif</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="The typography of ʿ and ʾ and a method to render them from scratch in LaTeX" />
<meta property="og:locale" content="en" />
<meta name="description" content="In this post I describe typographical problems introduced by the characters ʿ and ʾ used in transcription of Arabic. I present a font independent (well, largely) method of rendering them in LaTeX with the XeTeX engine. The code used for this is explained in some detail and is given in its entirety at the end of this post." />
<meta property="og:description" content="In this post I describe typographical problems introduced by the characters ʿ and ʾ used in transcription of Arabic. I present a font independent (well, largely) method of rendering them in LaTeX with the XeTeX engine. The code used for this is explained in some detail and is given in its entirety at the end of this post." />
<link rel="canonical" href="http://localhost:4000/typographyofaynandhamza/" />
<meta property="og:url" content="http://localhost:4000/typographyofaynandhamza/" />
<meta property="og:site_name" content="Uppercase Alif" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-02-10T00:00:00+01:00" />
<script type="application/ld+json">
{"description":"In this post I describe typographical problems introduced by the characters ʿ and ʾ used in transcription of Arabic. I present a font independent (well, largely) method of rendering them in LaTeX with the XeTeX engine. The code used for this is explained in some detail and is given in its entirety at the end of this post.","@type":"BlogPosting","headline":"The typography of ʿ and ʾ and a method to render them from scratch in LaTeX","dateModified":"2016-02-10T00:00:00+01:00","datePublished":"2016-02-10T00:00:00+01:00","url":"http://localhost:4000/typographyofaynandhamza/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/typographyofaynandhamza/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">

         <a href="/" class="site-avatar"><img src="http://andreasmhallberg.github.io/logo/logo2.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Uppercase Alif</a></h1>
            <p class="site-description">Andreas Hallberg's notes on Arabic linguistics, Vim and LaTeX.</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/tags">Tags</a>
            <a href="/documents">Docs</a>
            <a href="/about">About</a>
          </nav>

        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>The typography of ʿ and ʾ and a method to render them from scratch in LaTeX:</br><i></i></h1>

  <div class="date">

    

    
    February 10, 2016<br>
    
    Tags:  -latex -typography -transcription<br>
    Length: long<br>
    

    


    

  </div>



  <div class="entry">
    <p>In this post I describe typographical problems introduced by the characters ʿ and ʾ used in transcription of Arabic. I present a font independent (well, largely) method of rendering them in LaTeX with the XeTeX engine. The code used for this is explained in some detail and is given in its entirety at the end of this post.</p>

<h2 id="introduction">Introduction</h2>
<p>In linguistics, transcriptions of various kinds are often used to represent features and sound that are not covered in any straightforward way by the Latin alphabet. In Arabic there are a number of sounds that have no representations in the Latin alphabet, and various systems have been devised to expand the Latin alphabet in order to accurately represent them. Most of the extra characters in these systems are modifications of Latin letters. To represent the hissing sound of the Arabic letter ح, for example, linguists often use the letter <em>h</em> with a dot below: <em>ḥ</em>. Other fricatives sounds are often written with a line below a letter. To write the sound represented in the Arabic alphabet with ذ, linguists use <em>d</em> with a line below: <em>ḏ</em>. (This is pronounced with a tone, as <em>th</em> in <em>the</em>, and not as the toneless <em>th</em> in <em>birth</em>.) These modified characters are from a typographical point of view largely unproblematic. The dot below is usually the same size and shape as the full stop of the font. The line below a letter often takes the same form of the macron (¯). These modified characters are thus very simple to design with elements already present the font, and since the modifications are vertical they do not interact with neighboring letters. The letters ʿ and ʾ are, typographically, completely different and require special typesetting-attention.</p>

<h2 id="the-problem">The problem</h2>
<p>The Arabic letters (and sounds) <em>hamza</em> (ء) and <em>ʿayn</em> (ع) are transcribed as small, raised half circles, ʾ and ʿ respectively (U+02BE and U+02BF). These characters are not modifications of letters but completely new characters added to the alphabet. As such they often interact with neighboring letters in ways that type designers have not accounted for and it is accordingly not uncommon to see very poor renderings of these characters. The introduction to the popular <em>al-Kitaab</em> series of Arabic text books<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> provides an example of how things may go wrong:</p>

<p><img src="/images/alkitaab.png" alt="ʿ in *al-Kitaab*" /></p>

<p>These characters typically receive little attention by type designers, which is of course understandable seeing to their very specialized use. This is particularly noticeable when it comes to kerning (spacing between letters), as in the example above. With these characters being optically very light but still taking up horizontal space they often visually split the word in two, not being able to fill up the space they occupy. In the examples below, this is particularly noticeable in Times New Roman. Gentium Plus, a free font designed to cover multiple languages, nicely solves the problem by making the symbol larger than in most other typefaces. Latin Modern Roman (which builds on Computer Modern that Knuth designed for TeX) is another free alternative with a vast range of glyphs and weights for numerous languages. It’s ʿ is in fact a superscript <em>c</em>.</p>

<p><img src="/images/infonts.png" alt="ʿ in various fonts" /></p>

<p>The problem I faced when writing my thesis was that I wanted to use Minion Pro, which does not have these characters in its set of glyphs. Hence the spaces in the last example above. I wanted to create this character with the superscript <em>c</em>, as in Latin Modern. I like this design because it gives the characters more of a visual status as proper letter, as they are in Arabic. A nice thing with the superscript font is also that it exploits the work done by the type designer to make this smaller letter optically balanced with the other characters. Taking a regular small <em>c</em> and shrink it down would make it too thin and light. The superscript, as also small caps, is not simply smaller, it as also proportionally thicker to give it more wight.</p>

<p>Writing in LaTeX, I could do this by in effect creating a new character, so that when in the source code the is a <code class="highlighter-rouge">ʿ</code>, this is printed in the text with the character the superscript <em>c</em>. To make the ʾ (<em>hamza</em>), this <em>c</em> should be rotated 180 degrees so that the opening faces the left. 
This approach, as implemented below, has been adjusted for Adobe’s Minion Pro, but it can in be used with any font that has a superscript c, perhaps with some tweaking in kerning values. This method requires the document to be compiled with the XeTeX engine.</p>

<h2 id="making-the-characters">Making the characters</h2>
<p>Before we start we need the following in the preamble to load the required packages:</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\usepackage</span><span class="p">{</span>ifthen<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>fontspec<span class="p">}</span>
<span class="k">\setmainfont</span><span class="p">{</span>Minion Pro<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>rotating<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>etoolbox<span class="p">}</span>
</code></pre></div></div>

<p>First we need the actual characters bound to commands which we call <code class="highlighter-rouge">\ayn</code> and <code class="highlighter-rouge">\hamza</code>. The ʿ is simply this superscript <em>c</em>. To make the ʾ we rotate the character 180 degrees around its center.<sup id="fnref:3"><a href="#fn:3" class="footnote">2</a></sup> Finally we bind these to the input characters <code class="highlighter-rouge">ʿ</code> and <code class="highlighter-rouge">ʾ</code> by changing the catcode (category code) of these characters to active, basically making them one letter commands, and defining them as <code class="highlighter-rouge">\ayn</code> and <code class="highlighter-rouge">\hamza</code>.</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\newcommand\hamza</span><span class="p">{</span><span class="k">\textsuperscript</span><span class="p">{</span><span class="c">%</span>
	c<span class="p">}}</span><span class="c">%</span>
	<span class="p">}</span>

<span class="k">\newcommand\hamza</span><span class="p">{</span><span class="c">%</span>
		<span class="k">\textsuperscript</span><span class="p">{</span><span class="k">\rotatebox</span><span class="na">[origin=c]</span><span class="p">{</span>180<span class="p">}{</span>c<span class="p">}}</span>
	<span class="p">}</span>

<span class="k">\catcode</span>`ʾ=<span class="k">\active</span>
<span class="k">\catcode</span>`ʿ=<span class="k">\active</span>
<span class="k">\def</span>ʿ<span class="k">\ayn</span>
<span class="k">\def</span>ʾ<span class="k">\hamza</span>
</code></pre></div></div>

<p><img src="/images/output1.png" alt="output1" /></p>

<p>The characters look nice, but as you can see the kerning in the italic is pretty bad. We need to fix this.</p>

<h2 id="kerning">Kerning</h2>
<p>The space after the ʿ in the italic is too large and it sits a bit to tight on the preceding letter. In linguistic literature, transcriptions are by convention in italics, so this will usually be the form ʾ and ʿ shows up in. The kerning in the upright roman is OK for now.</p>

<p>We need to have different kerning in the upright and in the italic. One way to achieve this is to make a command to test for italicness, as in the following:</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\makeatletter</span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\IfItElse</span><span class="p">}{</span><span class="c">%</span>
 <span class="k">\ifx\f</span>@shape<span class="k">\my</span>@test@it
   <span class="k">\expandafter\@</span>firstoftwo
 <span class="k">\else</span>
   <span class="k">\expandafter\@</span>secondoftwo
 <span class="k">\fi</span>
<span class="p">}</span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\my</span>@test@it<span class="p">}{</span>it<span class="p">}</span>
<span class="k">\makeatother</span>
</code></pre></div></div>

<p>We add this to the preamble somewhere. This gives the command <code class="highlighter-rouge">\IfItElse</code> that takes two arguments. The first states what happens if the text is italic, the second what happens if it is not. By changing the commands of the new characters by placing this before and after, with different kerning in the two arguments, we can add or remove space before and after these characters in these two conditions. With the new commands below a small space of 0.02 em (two hundredths of the width of a capital M) is added before the letter, but only if it is in italic, and the space after the letter is reduced by 0.1 em., but only in italic. (It always surprises me how very small differences in spacing are clearly noticeable.)</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\newcommand\ayn</span><span class="p">{</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>.02em<span class="p">}{}</span><span class="c">%</span>
	    <span class="k">\textsuperscript</span><span class="p">{</span>c<span class="p">}</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>-.1em<span class="p">}{}</span><span class="c">%</span>
	<span class="p">}</span>

<span class="k">\newcommand\hamza</span><span class="p">{</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>.02em<span class="p">}{}</span><span class="c">%</span>
		<span class="k">\textsuperscript</span><span class="p">{</span><span class="k">\rotatebox</span><span class="na">[origin=c]</span><span class="p">{</span>180<span class="p">}{</span>c<span class="p">}}</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>-.1em<span class="p">}{}</span><span class="c">%</span>
	<span class="p">}</span>
</code></pre></div></div>

<p>And this is the output:</p>

<p><img src="/images/output2.png" alt="output2" /></p>

<p>This is much better. We could stop here. But we won’t. The tricky thing with kerning is that it needs to be different for different character combinations. Look at this example, produced with the command above:</p>

<p><img src="/images/output3.png" alt="output3" /></p>

<p>Each line here shows ʿ in combinations with characters that give odd spacing. In the first word the diagonal side of A leaves too much space. In the second the space after the hyphen below the ʿ makes the word seem disjointed. Since the Arabic definite article <em>al</em> is usually written with a hyphen, this combination is very frequent. In the last word the space below the ʿ makes the punctuation mark seem much too lonely.</p>

<p>In XeTeX, we can fix this with <code class="highlighter-rouge">interchartoks</code>. With these we can specify groups of characters (and each group may contain only one character) and have a command automatically inserted between specific character groups whenever they are in direct succession. This can be exploited for kerning of specific character combinations.</p>

<p>First we need to turn on this feature with <code class="highlighter-rouge">\XeTeXinterchartokenstate=1</code>. We then declare the three different groups we need with <code class="highlighter-rouge">\newXeTeXintercharclass</code> and assign characters to each group with <code class="highlighter-rouge">\XeTeXcharclass</code>. (Note that <code class="highlighter-rouge">Ā</code> is included in the same group as<code class="highlighter-rouge">A</code>, and <code class="highlighter-rouge">,</code> as the same group as <code class="highlighter-rouge">.</code> since these give rise to the same problem and need the same kerning.)</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\XeTeXinterchartokenstate</span>=1

<span class="k">\newXeTeXintercharclass\punct</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\.</span>=<span class="k">\punct</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\,</span>=<span class="k">\punct</span>


<span class="k">\newXeTeXintercharclass\capA</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\A</span>=<span class="k">\capA</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\Ā</span>=<span class="k">\capA</span>

<span class="k">\newXeTeXintercharclass\hyph</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\-</span>=<span class="k">\hyph</span>


<span class="k">\newXeTeXintercharclass\aynhamza</span>
<span class="k">\XeTeXcharclass</span> "FEFF=<span class="k">\aynhamza</span> <span class="c">% hamza and ayn</span>
</code></pre></div></div>

<p>The last class here is where things get tricky. We now need to assign a character class to our newly created ʿ and ʾ. The problem is that XeTeX will not see  ʿ and ʾ but the <em>c</em> in the underlaying code that renders them. And we do not want this kerning also to apply to the cA combination. So we can’t assign <em>c</em> to this class. One of the wizards at TEX.SE came up with <a href="http://tex.stackexchange.com/questions/180409/xetex-kerning-with-newunicodechar">this solution</a>: we include in the commands generating our new characters a Unicode character that takes no space and that is unused. Enter U+FEFF, aka <em>zero width no-break space</em>. We put this at the beginning and the end of the character commands, with a somewhat odd annotation:</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">\newcommand\ayn</span><span class="p">{</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>.02em<span class="p">}{}</span><span class="c">%</span>
	    <span class="k">\textsuperscript</span><span class="p">{</span>c<span class="p">}</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>-.1em<span class="p">}{}</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="p">}</span>

<span class="k">\newcommand\hamza</span><span class="p">{</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>.02em<span class="p">}{}</span><span class="c">%</span>
		<span class="k">\textsuperscript</span><span class="p">{</span><span class="k">\rotatebox</span><span class="na">[origin=c]</span><span class="p">{</span>180<span class="p">}{</span>c<span class="p">}}</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>-.1em<span class="p">}{}</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="p">}</span>
</code></pre></div></div>

<p>Now what LaTeX (really XeTeX) will see when it comes across a ʿ in the input file is something like</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[U+FEFF]c[U+FEFF]
</code></pre></div></div>

<p>We can then assign FEFF to a XeTeX character class to represent ʿ and ʾ, as is done in the last <code class="highlighter-rouge">\XeTeXcharclass</code> in the declarations above.</p>

<p>We now declare kerning commands to be inserted between these combinations of character classes. Note that you need to be explicit about the ordering of character classes and that different orderings may have different results.</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\XeTeXinterchartoks</span> <span class="k">\aynhamza</span> <span class="k">\capA</span> =<span class="p">{</span><span class="k">\kern</span> -.1em<span class="p">}</span> <span class="c">% ʿ/ʾ then A</span>
<span class="k">\XeTeXinterchartoks</span> <span class="k">\capA</span> <span class="k">\aynhamza</span> =<span class="p">{</span><span class="k">\kern</span> -.1em<span class="p">}</span> <span class="c">%  A then ʿ/ʾ </span>

<span class="k">\XeTeXinterchartoks</span> <span class="k">\aynhamza</span> <span class="k">\punct</span> =<span class="p">{</span><span class="k">\kern</span> -.15em<span class="p">}</span> <span class="c">% ʿ/ʾ then ./,</span>

<span class="k">\XeTeXinterchartoks</span> <span class="k">\hyph</span> <span class="k">\aynhamza</span> =<span class="p">{</span><span class="k">\kern</span> -.05em<span class="p">}</span> <span class="c">% - then ʿ/ʾ </span>
<span class="k">\XeTeXinterchartoks</span> <span class="k">\aynhamza</span>  <span class="k">\hyph</span>=<span class="p">{</span><span class="k">\kern</span> -.05em<span class="p">}</span> <span class="c">% ʿ/ʾ then - </span>
</code></pre></div></div>

<p>Now the output looks like this:</p>

<p><img src="/images/output4.png" alt="output4" /></p>

<p>Much better. Just applying these kernings will improve the text considerably. There are however many more combinations of ʿ and ʾ with other characters that would need its own kerning values. You can add kerning as they show up in the text.</p>

<h2 id="alignment-in-tabular-environments">Alignment in tabular environments</h2>
<p>Another typographical problem with ʿ and ʾ is that they look odd when they are the first letter in word appearing in a list or a similarly  aligned environment. The space beneath a word-initial ʿ and ʾ makes the word look indented. This problem appears in many lists of Arabic words or names:</p>

<p><img src="/images/output5.png" alt="output5" /></p>

<p>In linguistic literature this also often shows up in glossed examples since the transcription is aligned with the translation:</p>

<p><img src="/images/output6.png" alt="output6" /></p>

<p>This may by matter of taste, but it really annoys me, especially with <em>ʾana</em> being aligned to I. Articles in linguistics will often have dozens of such examples, so it really builds up quickly.</p>

<p>What we want here is the ʿ and ʾ to protrude slightly to the left to get a better optical alignment. Any automatic solution to this would be tricky.<sup id="fnref:4"><a href="#fn:4" class="footnote">3</a></sup> What I’ve done in these cases is simply to write custom command instead of ʿ and ʾ. These command names are best kept short since you might have to write them a lot. Keeping them short also makes the readability of source code suffer as little as possible. We can define <code class="highlighter-rouge">\la</code> (left <em>ʿayn</em>) and <code class="highlighter-rouge">\lh</code> (left <em>hamza</em>) to use in these situations:</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\newcommand*</span><span class="p">{</span><span class="k">\la</span><span class="p">}{</span><span class="k">\hspace*</span><span class="p">{</span>-.2em<span class="p">}</span>ʿ<span class="p">}</span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\lh</span><span class="p">}{</span><span class="k">\hspace*</span><span class="p">{</span>-.2em<span class="p">}</span>ʾ<span class="p">}</span>
</code></pre></div></div>

<p>These prints the appropriate character but with a small negative space of 0.2 preceding them, pulling them slightly to the left. And we get something much prettier:</p>

<p><img src="/images/output7.png" alt="output7" /></p>

<h2 id="conclusion">Conclusion</h2>
<p>The characters ʿ and ʾ are in many otherwise either absent or poorly designed. This post has described a way of creating them from scratch in LaTeX. This method has the advantage of being in principle font independent, provided that the font has a superscript <em>c</em>. (I have used it with <a href="https://www.google.com/fonts/specimen/Source+Sans+Pro">Source Sans Pro</a> to great effect with these exact same kerning values but have not tested it with other fonts.) It takes elements present in the font and modifies them to make the new characters.</p>

<p>There is one problem with this approach that I have not yet solved. In the pdf output the character renders as expected but it is internally represented as <em>c</em>, so if you copy the word <em>muʿallim</em> from the pdf you get <em>mucallim</em>. I might come back here and add a fix once I figure it out.</p>

<h2 id="complete-code">Complete code</h2>
<p>The code below can be added to the preamble without any further modifications the document to have these kerning applied. It also provides the <code class="highlighter-rouge">\la</code> and <code class="highlighter-rouge">\lh</code> commands for use in tabular environments as described above.</p>

<div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\usepackage</span><span class="p">{</span>ifthen<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>fontspec<span class="p">}</span>
<span class="k">\setmainfont</span><span class="p">{</span>Minion Pro<span class="p">}</span> <span class="c">% or other font with a superscript c</span>
<span class="k">\usepackage</span><span class="p">{</span>rotating<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>etoolbox<span class="p">}</span>

 <span class="k">\newcommand\ayn</span><span class="p">{</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>.02em<span class="p">}{}</span><span class="c">%</span>
	    <span class="k">\textsuperscript</span><span class="p">{</span>c<span class="p">}</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>-.1em<span class="p">}{}</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="p">}</span>

<span class="k">\newcommand\hamza</span><span class="p">{</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>.02em<span class="p">}{}</span><span class="c">%</span>
		<span class="k">\textsuperscript</span><span class="p">{</span><span class="k">\rotatebox</span><span class="na">[origin=c]</span><span class="p">{</span>180<span class="p">}{</span>c<span class="p">}}</span><span class="c">%</span>
	<span class="k">\IfItElse</span><span class="p">{</span><span class="k">\kern</span>-.1em<span class="p">}{}</span><span class="c">%</span>
	<span class="p">^^^^</span>feff<span class="c">%</span>
	<span class="p">}</span>

<span class="c">% Bind to Unicode chars and robustify</span>
<span class="k">\catcode</span>`ʾ=<span class="k">\active</span>
<span class="k">\catcode</span>`ʿ=<span class="k">\active</span>
<span class="k">\def</span>ʿ<span class="p">{</span><span class="k">\ayn</span><span class="p">}</span>
<span class="k">\def</span>ʾ<span class="p">{</span><span class="k">\hamza</span><span class="p">}</span>


<span class="k">\robustify</span><span class="p">{</span>ʿ<span class="p">}</span>
<span class="k">\robustify</span><span class="p">{</span>ʾ<span class="p">}</span>

<span class="c">% Test for italicness</span>
<span class="k">\makeatletter</span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\IfItElse</span><span class="p">}{</span><span class="c">%</span>
 <span class="k">\ifx\f</span>@shape<span class="k">\my</span>@test@it
   <span class="k">\expandafter\@</span>firstoftwo
 <span class="k">\else</span>
   <span class="k">\expandafter\@</span>secondoftwo
 <span class="k">\fi</span>
<span class="p">}</span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\my</span>@test@it<span class="p">}{</span>it<span class="p">}</span>
<span class="k">\makeatother</span>



<span class="c">% Kerning with XeTeX</span>
<span class="k">\XeTeXinterchartokenstate</span>=1

<span class="k">\newXeTeXintercharclass\punct</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\.</span>=<span class="k">\punct</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\,</span>=<span class="k">\punct</span>


<span class="k">\newXeTeXintercharclass\capA</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\A</span>=<span class="k">\capA</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\Ā</span>=<span class="k">\capA</span>

<span class="k">\newXeTeXintercharclass\hyph</span>
<span class="k">\XeTeXcharclass</span> `<span class="k">\-</span>=<span class="k">\hyph</span>


<span class="k">\newXeTeXintercharclass\aynhamza</span>
<span class="k">\XeTeXcharclass</span> "FEFF=<span class="k">\aynhamza</span> <span class="c">% hamza and ayn</span>

<span class="k">\XeTeXinterchartoks</span> <span class="k">\aynhamza</span> <span class="k">\capA</span> =<span class="p">{</span><span class="k">\kern</span> -.1em<span class="p">}</span> <span class="c">% ʿ/ʾ then A</span>
<span class="k">\XeTeXinterchartoks</span> <span class="k">\capA</span> <span class="k">\aynhamza</span> =<span class="p">{</span><span class="k">\kern</span> -.05em<span class="p">}</span> <span class="c">%  A then ʿ/ʾ </span>

<span class="k">\XeTeXinterchartoks</span> <span class="k">\aynhamza</span> <span class="k">\punct</span> =<span class="p">{</span><span class="k">\kern</span> -.15em<span class="p">}</span> <span class="c">% ʿ/ʾ then ,/.</span>

<span class="k">\XeTeXinterchartoks</span> <span class="k">\hyph</span> <span class="k">\aynhamza</span> =<span class="p">{</span><span class="k">\kern</span> -.05em<span class="p">}</span> <span class="c">% - then ʿ/ʾ </span>
<span class="k">\XeTeXinterchartoks</span> <span class="k">\aynhamza</span>  <span class="k">\hyph</span>=<span class="p">{</span><span class="k">\kern</span> -.05em<span class="p">}</span> <span class="c">% ʿ/ʾ then - </span>

<span class="c">% Commands for left protruding hamza and ayn when word inital in tabular envs. </span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\la</span><span class="p">}{</span><span class="k">\hspace*</span><span class="p">{</span>-.15em<span class="p">}</span>ʿ<span class="p">}</span>
<span class="k">\newcommand*</span><span class="p">{</span><span class="k">\lh</span><span class="p">}{</span><span class="k">\hspace*</span><span class="p">{</span>-.15em<span class="p">}</span>ʾ<span class="p">}</span>
</code></pre></div></div>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Brustad, K., Al-Batal, M. &amp; al-Tunsi, A., 2011. <em>al-Kitaab fī Taʿallum al-ʿArabiyya: A Textbook for Beginning Arabic,</em> Washington, D.C.: Georgetown University Press. <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>Another option is to mirror it. This would have the benefit of keeping the rounded end of the pen stroke in the upper part, keeping the design of the glyph. By rotating it we are basically reversing the troke, which is not not esthetically optimal. However, by rotating rather than mirroring it we make sure that it keeps its exact slant in the italic. Mirroring it makes it lean to left rather then the right, which of course will not do. <a href="#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:4">
      <p>Partial sucess: <a href="http://tex.stackexchange.com/questions/176335/alignment-of-arabic-transcriptions-%CA%BE-and-%CA%BF">http://tex.stackexchange.com/questions/176335/alignment-of-arabic-transcriptions-%CA%BE-and-%CA%BF</a> <a href="#fnref:4" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
          <footer class="footer">
            <p>
            
<a href="mailto:andreasmartenhallberg@gmail.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/andreasmhallberg"><i class="svg-icon github"></i></a>



<a href="/feed.xml"><i class="svg-icon rss"></i></a>




            </p>
            <p>
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons-licens" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Uppercase Alif</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://andreasmhallberg.github.io/" property="cc:attributionName" rel="cc:attributionURL">Andreas Hallberg</a> is licensed under a<br><a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            </p>
          </footer>
      </div>
    </div>



  </body>
</html>
